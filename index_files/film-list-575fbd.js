webpackJsonp([2],{29:function(e,t,n){"use strict";var i=(n(4),n(1)),s=(n(10),i.createClass({displayName:"ImagePlaceholder",propTypes:{src:i.PropTypes.string,placeholder:i.PropTypes.string,errorSrc:i.PropTypes.string,className:i.PropTypes.string},getDefaultProps:function(){return{src:"",placeholder:"",errorSrc:"",className:""}},getInitialState:function(){return{success:!1,error:!1}},updateSource:function(){var e=this,t=this.props.src;this._image.onload=function(){e.isMounted()&&(e.setState({success:!0}),e._image.onload=null)},this._image.onerror=function(t){e.isMounted()&&(e.setState({error:!0}),e._image.onerror=null)},this._image.src=t},componentWillMount:function(){this._image=new Image},componentDidMount:function(){this.updateSource()},componentDidUpdate:function(e,t){e.src!==this.props.src&&this.updateSource()},render:function(){var e,t=this.props.className,n=this.props.placeholder;return e=this.state.success?this.props.src:this.state.error&&this.props.errorSrc?this.props.errorSrc:n,i.createElement("div",{className:t,style:{backgroundSize:"100%",backgroundImage:"url("+n+")"}},i.createElement("img",{src:e,style:{width:"100%",WebkitTransition:"all 1.2s ease",opacity:this.state.success?1:.01}}))}}));e.exports=s},36:function(e,t){"use strict";e.exports=function(e,t,n){var i=[],s=function(n){var s,r=this;return r.element=n,s=function(){var n,i=t.createEvent("Event");i.initEvent("scroll",!0,!0);var s=function(){r.element.dispatchEvent(i)},o=function(){n=setInterval(s,20)},a=function(){clearInterval(n)};"ontouchstart"in e&&(r.element.addEventListener("touchstart",o),r.element.addEventListener("touchmove",s),r.element.addEventListener("touchend",a))},i.indexOf(r.element)===-1&&(i.push(r.element),s()),r};return s.prototype.addListener=function(e){this.element.addEventListener("scroll",e)},s.prototype.removeListener=function(e){this.element.removeEventListener("scroll",e)},s.prototype.dispatch=function(){var e=t.createEvent("Event");e.initEvent("scroll",!0,!0),this.element.dispatchEvent(e)},s}(window,document,_)},41:function(e,t,n){e.exports=n.p+"asset/3d2cdb3bd9a23609aa2d84e7c2bfd035.png"},48:function(e,t,n){"use strict";var i=(n(4),n(1)),s=n(10),r=n(36),o=120,a=new r($(window).get(0)),l=i.createClass({displayName:"BackToTop",propTypes:{},getDefaultProps:function(){return{}},getInitialState:function(){return{show:!1}},handleClick:function(){$("body").animate({scrollTop:0},400)},componentDidMount:function(){var e=this;a.addListener(function(){e.isMounted()&&e.setState({show:$("body").scrollTop()>o})})},render:function(){return i.createElement("div",{className:"cpn-back-to-top "+(this.props.className||"")+(this.state.show?"":" cpn-back-to-top-hide"),onClick:this.handleClick},i.createElement("div",{className:"circle"},i.createElement(s,null,"top")))}});e.exports=l},62:function(e,t,n){"use strict";var i=n(36),s=function(e){var t=this;return t.options=$.extend({},e),t.options.tail=$.extend({$container:$(document),$content:$(document),bindBottom:!0},t.options.tail||{}),t.options.success=function(n,i,s){var r=e.success||$.noop;return r.call(t,n,i,s)},t.options.error=function(n,i,s){var r=e.error||$.noop;return r.call(t,n,i,s)},t.options.complete=function(n,i,s){var r=e.complete||$.noop;return r.call(t,n,i,s)},t.locked=!1,t.fastScroll=new i(t.options.tail.$container.get(0)),t.options.tail.bindBottom&&t.bindBottom(t.options.tail.$container,t.options.tail.$content),t};s.prototype.fetch=function(){return this.locked?this:(this.locked=!0,$.ajax(this.options),this)},s.prototype.data=function(e,t){return 1===arguments.length?this.options.data[e]:(this.options.data[e]=t,this)},s.prototype.inc=function(e,t){return this.options.data[e]+=t="undefined"==typeof t?1:t},s.prototype.dec=function(e,t){return this.options.data[e]-=t="undefined"==typeof t?1:t},s.prototype.unlock=function(){var e=this;return setTimeout(function(){e.locked=!1},0),e},s.prototype.bindBottom=function(e,t){var n=this;return e=e||$(document),t=t||$(document),n.onscroll=function(){e.scrollTop()+$(window).height()>t.height()-800&&n.fetch()},n.fastScroll.addListener(n.onscroll),n},s.prototype.unbind=function(){return this.fastScroll.removeListener(this.onscroll),this},s.prototype.trigger=function(){return this.fastScroll.dispatch(),this},$.extend({tailLoader:function(e){return new s(e)}}),e.exports=s},78:function(e,t,n){"use strict";var i=n(24);e.exports=i({NOW_PLAYING:null,COMING_SOON:null})},104:function(e,t,n){e.exports=n.p+"asset/23568dc30235133ebeec89fbded3863b.png"},157:function(e,t,n){"use strict";var i=n(1),s=(n(11),n(2).redirect,n(12),n(62),n(48)),r=n(516),o=n(515),a=n(517),l=n(78),c=n(8),m=i.createClass({displayName:"FilmView",mixins:[c],componentDidMount:function(){this.getFlux().actions.application.setNavbar({type:"menu"})},render:function(){var e;return e=this.props.filter===l.COMING_SOON?i.createElement(o,null):i.createElement(a,null),i.createElement("section",{className:"film-view"},i.createElement("div",{className:"film-list-wrap"},i.createElement(r,{filter:this.props.filter}),e,i.createElement(s,null)))}});e.exports=m},515:function(e,t,n){"use strict";var i=n(1),s=n(4),r=n(3),o=(n(11),n(32)),a=(n(42),n(10)),l=n(2).redirect,c=n(12),m=n(62),p=(n(78),n(29)),u=i.createClass({displayName:"ComingSoonFilmItem",handleClick:function(){l("#!/film/"+this.props.film.id)},render:function(){var e=this,t=e.props.film.isPresold?i.createElement("div",{className:"film-tip-icon"},i.createElement(a,{className:"film-yu-icon"},"yu-filled")):i.createElement("div",{className:"film-next-arrow"},i.createElement(a,{className:"film-next-icon"},"arrow-right"));return i.createElement("li",null,i.createElement("div",{className:"film-item",onClick:this.handleClick},i.createElement("div",{className:"film-item-img"},i.createElement(p,{className:"img-responsive",src:this.props.film.poster.thumbnail,placeholder:n(41),alt:""})),i.createElement("div",{className:"film-desc"},t,i.createElement("div",{className:"film-name"},this.props.film.name),i.createElement("div",{className:"film-intro"},this.props.film.intro),i.createElement("div",{className:"film-premiere-date"},r(+this.props.film.premiereAt).format("M月D日上映"),"    ",r(+this.props.film.premiereAt).format("dddd")))))}}),d=i.createClass({displayName:"ComingSoonFilmList",getTailLoader:function(){var e=this,t=new m({url:"/v4/api/film/coming-soon",data:{page:1,count:7},type:"get",dataType:"json",beforeSend:function(){c.start()},complete:function(){c.done()},error:function(){this.unlock()},success:function(t){e.isMounted()&&(this.inc("page"),e.setState({films:e.state.films.concat(t.data.films||[])}),this.data("page")>t.data.page.total?this.unbind():this.unlock())}});return t.trigger(),t},getInitialState:function(){return{films:[]}},componentDidMount:function(){o.track("浏览影片列表",{"是否在映":"即将上映"}),this.tailLoader=this.getTailLoader()},componentWillUnmount:function(){this.tailLoader.unbind()},render:function(){var e;return e=s.map(this.state.films,function(e){return i.createElement(u,{key:e.id,film:e})}),i.createElement("div",{className:"film-list"},i.createElement("ul",{className:"list-unstyled"},e))}});e.exports=d},516:function(e,t,n){"use strict";var i=n(1),s=n(78),r=i.createClass({displayName:"Navbar",render:function(){return i.createElement("div",{className:"film-list-nav"},i.createElement("a",{href:"#!/film"},i.createElement("div",{className:(this.props.filter===s.NOW_PLAYING?"choosing":"")+" now-playing"},"正在热映")),i.createElement("a",{href:"#!/film/coming-soon"},i.createElement("div",{className:(this.props.filter===s.COMING_SOON?"choosing":"")+" coming-soon"},"即将上映")))}});e.exports=r},517:function(e,t,n){"use strict";var i=n(1),s=n(4),r=(n(3),n(11),n(42),n(10)),o=n(2).redirect,a=n(12),l=n(62),c=n(32),m=(n(78),n(29)),p=i.createClass({displayName:"NowPlayingFilmItem",handleClick:function(){o("#!/film/"+this.props.film.id)},render:function(){return i.createElement("li",null,i.createElement("div",{className:"film-item",onClick:this.handleClick},i.createElement("div",{className:"film-item-img"},i.createElement(m,{className:"img-responsive",src:this.props.film.poster.thumbnail,placeholder:n(104),alt:""})),i.createElement("div",{className:"film-desc"},i.createElement("div",{className:"film-next-arrow"},i.createElement(r,{className:"film-next-icon"},"arrow-right")),i.createElement("div",{className:"film-grade"},this.props.film.grade),i.createElement("div",{className:"film-name"},this.props.film.name),i.createElement("div",{className:"film-intro"},this.props.film.intro),i.createElement("div",{className:"film-counts"},i.createElement("span",{className:"film-count-color1"},this.props.film.cinemaCount||0),"家影院上映        ",i.createElement("span",{className:"film-count-color1"},this.props.film.watchCount||0),"人购票  "))))}}),u=i.createClass({displayName:"NowPlayingFilmList",getTailLoader:function(){var e=this,t=new l({url:"/v4/api/film/now-playing",data:{page:1,count:7},type:"get",dataType:"json",beforeSend:function(){a.start()},complete:function(){a.done()},error:function(){this.unlock()},success:function(t){e.isMounted()&&(this.inc("page"),e.setState({films:e.state.films.concat(t.data.films||[])}),this.data("page")>t.data.page.total?this.unbind():this.unlock())}});return t.trigger(),t},getInitialState:function(){return{films:[]}},componentDidMount:function(){c.track("浏览影片列表",{"是否在映":"正在上映"}),this.tailLoader=this.getTailLoader()},componentWillUnmount:function(){this.tailLoader.unbind()},render:function(){var e;return e=s.map(this.state.films,function(e){return i.createElement(p,{key:e.id,film:e})}),i.createElement("div",{className:"film-list"},i.createElement("ul",{className:"list-unstyled"},e))}});e.exports=u}});