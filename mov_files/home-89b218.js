webpackJsonp([20],{485:function(e,t,n){"use strict";var a=n(4),r=n(1),i=(n(7),n(11),n(2).redirect),s=n(2).hasLogged,l=n(2).toLogin,c=n(8),o=n(6).StoreWatchMixin,u=n(487),m=n(486),p=r.createClass({displayName:"CenterMain",mixins:[c,o("MeStore","AuthStore")],getStateFromFlux:function(){return{user:this.getFlux().store("MeStore").getMe(),isLogged:this.getFlux().store("AuthStore").getStatus()}},componentDidMount:function(){var e=this.getFlux();return s()?(e.actions.me.get(),void e.actions.application.setNavbar({title:"我的"})):l()},componentDidUpdate:function(e,t){if(this.state.isLogged===!1)return setTimeout(a.partial(i,"#!/login",{trigger:!0,replace:!0}),0)},render:function(){var e=this.state.user.attributes;return r.createElement("section",{className:"center-home-view"},r.createElement(u,{user:e}),r.createElement(m,{user:e}))}});e.exports=p},486:function(e,t,n){"use strict";var a=n(1),r=n(86),i=n(7),s=(n(11),n(10)),l=n(2).redirect,c=n(8),o=n(21),u=a.createClass({displayName:"Nav",render:function(){return a.createElement("div",{className:"menu-wrapper "+(this.props.className||""),onClick:this.props.onClick},a.createElement("div",{className:"menu center-block"},a.createElement(s,{className:"menu-icon"},this.props.icon),a.createElement("span",{className:"title"},this.props.title),a.createElement("div",{className:"pull-right"},a.createElement("span",{className:"value-wrap"},a.createElement("span",{className:"value"},this.props.num||0),"账户余额"===this.props.title?" 元":" 张"),"账户余额"===this.props.title?a.createElement("span",{className:"trigger-icon"},"刷新 "):a.createElement(s,{className:"trigger-icon"},"arrow-right"))))}}),m=a.createClass({displayName:"Order",handleClick:function(){l("#!/center/ticket")},render:function(){return a.createElement(u,{onClick:this.handleClick,num:this.props.num,title:"我的订单",icon:"ticket-filled"})}}),p=a.createClass({displayName:"Preorder",handleClick:function(){l("#!/preorder")},render:function(){return a.createElement(u,{onClick:this.handleClick,num:this.props.num,title:"待付订单",icon:"sandglass-filled"})}}),d=a.createClass({displayName:"Coupon",handleClick:function(){l("#!/center/coupon")},render:function(){return a.createElement(u,{className:"cash",num:this.props.num,onClick:this.handleClick,title:"我的现金券",icon:"coupon-filled"})}}),h=a.createClass({displayName:"Coin",mixins:[c],componentDidMount:function(){this.setState({num:this.props.num})},handleClick:function(){var e=this;this.spinIcon(),this.getFlux().actions.me.getCoin(function(){e.stopSpinIcon()})},stopSpinIcon:function(){var e=this.findLoadingIcon(),t=e.getAttribute("class");e.setAttribute("class",t.replace(/active/,""))},spinIcon:function(){var e=this.findLoadingIcon(),t=e.getAttribute("class")+" active";e.setAttribute("class",t)},findLoadingIcon:function(){return r.findDOMNode(this).querySelector(".trigger-icon")},render:function(){return a.createElement(u,{className:"yinhua",num:this.props.num,onClick:this.handleClick,title:"账户余额",icon:"coin-filled"})}}),g=a.createClass({displayName:"Card",handleClick:function(){l("#!/card")},render:function(){return a.createElement(u,{className:"card",num:this.props.num,onClick:this.handleClick,title:o.tpl("我的{{CARD}}"),icon:"card-filled"})}}),f=a.createClass({displayName:"Setting",handleClick:function(){l("#!/setting")},render:function(){return a.createElement(u,{className:"setting",onClick:this.handleClick,title:"设置",icon:"setting-filled"})}}),C=a.createClass({displayName:"NavList",render:function(){var e=this.props.user;return a.createElement("section",{className:"center-nav"},a.createElement(m,{num:e.orderCount}),a.createElement(p,{num:e.preorderCount}),a.createElement(d,{num:i.get(e,"wallet.couponCount")}),a.createElement(h,{num:i.get(e,"wallet.coin")}),a.createElement(g,{num:i.get(e,"wallet.cardCount")}),a.createElement(f,null))}});e.exports=C},487:function(e,t,n){"use strict";var a=n(1),r=n(22),i=n(7),s=n(10),l=(n(11),n(2).redirect),c=n(37),o=n(5),u=n(8),m=n(6).StoreWatchMixin,p=a.createClass({displayName:"UserAvatar",render:function(){var e=n(608);return a.createElement("img",{className:"avatar",src:this.props.src||e})}}),d=a.createClass({displayName:"UserName",handelClick:function(){},render:function(){var e=(this.props.name?"inline-block":"none","");return this.props.name&&(e=a.createElement(s,{className:"i-modify",onClick:this.handelClick},"modify")),a.createElement("p",{className:"username"},a.createElement("span",null,this.props.name||"未登录"))}}),h=a.createClass({displayName:"UserId",render:function(){var e=null;return this.props.id&&(e=a.createElement("p",{className:"email"},"ID:"+this.props.id)),e}}),g=(a.createClass({displayName:"PhoneStatus",render:function(){return a.createElement("span",null,"已绑定 ",this.props.mobile,a.createElement("u",null," 绑定手机号 "))}}),a.createClass({displayName:"Logout",mixins:[u,m("MeStore","AuthStore")],getStateFromFlux:function(){return{isLogged:this.getFlux().store("AuthStore").getStatus()}},componentDidUpdate:function(){if(this.state.isLogged===!1)return setTimeout(_.partial(l,"#!/login",{trigger:!0,replace:!0}),0)},handelClick:function(){var e=this;confirm("你确定要退出当前账户？")&&e.getFlux().actions.auth.logout()},render:function(){return a.createElement("span",{className:"logout",onClick:this.handelClick},"退出")}})),f=a.createClass({displayName:"ToSetSecurityMobile",handleClick:function(){l("#!/setting/security-mobile")},render:function(){return a.createElement("span",{className:"bind",onClick:this.handleClick},"绑定手机")}}),C=a.createClass({displayName:"UserNameCard",render:function(){var e=this.props.user;return a.createElement("div",{className:"center-header-wrap"},a.createElement("header",null,a.createElement(p,{src:e.avatorUrl}),a.createElement("div",{className:"detail"},a.createElement(d,{name:e.name}),a.createElement(h,{id:e.id}),a.createElement("p",{className:"operation"},i.get(e,"setting.securityMobile")?null:a.createElement(f,null),c.app.isWeb()||r(o.COOKIE_DEBUG)?a.createElement(g,null):"")),a.createElement("div",{className:"clearfix"})))}});e.exports=C},608:function(e,t,n){e.exports=n.p+"asset/ca426920db24a84a0d98107f5fedc2cc.jpg"}});